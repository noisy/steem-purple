ifndef LIBDIR
	LIBDIR=lib
endif

ifndef FULL_LIBDIR
	FULL_LIBDIR=usr/${LIBDIR}
endif

PACKAGE_NAME= @PACKAGE_NAME@
EXECUTABLE_NAME = $(PACKAGE_NAME)-testrunner
CC= @CC@
CFLAGS= @CFLAGS@
INSTALL = @INSTALL@
INSTALL_PROGRAM = @INSTALL_PROGRAM@

# we haven't automake, and it is strange behaviour of the atoconf: it doesn't define INSTALL_PROGRAM

CFLAGS+=@PURPLE_CFLAGS@ @GTK_CFLAGS@ @CHECK_CFLAGS@ -fPIC -DPIC -std=c99
#CFLAGS+=-Wall -Wextra -Wconversion -Wsign-conversion -Winit-self -Wunreachable-code --pedantic  -Wstrict-aliasing
#CFLAGS+= -g -ggdb

LDFLAGS+=@PURPLE_LIBS@ @GTK_LIBS@ @CHECK_LIBS@ -ggdb -fPIC -DPIC

all: compile check
clean:
	rm -f $(EXECUTABLE_NAME)
	rm -f *.o
compile: mrim-util-test.o tests.o
	${CC} -o ${EXECUTABLE_NAME} mrim-util-test.o tests.o ../src/*.o ${LDFLAGS}
mrim-util-test.o: mrim-util-test.c ../src/mrim-util.h
	${CC} -c ${CFLAGS} -fPIC -DPIC -o mrim-util-test.o mrim-util-test.c
tests.o: tests.c tests.h
	${CC} -c ${CFLAGS} -fPIC -DPIC -o tests.o tests.c

check:
	./${EXECUTABLE_NAME}

# to avoid useless errors
install:
